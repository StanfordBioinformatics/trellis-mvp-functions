steps:
- name: 'gcr.io/cloud-builders/gcloud'
  args: [
         'beta',
         'functions',
         'deploy',
         'trellis-delete-blob',
         '--project=${PROJECT_ID}',
         '--source=functions/delete-blob',
         '--memory=128MB',
         '--max-instances=40',
         '--timeout=60',
         '--entry-point=delete_blob',
         '--runtime=python37',
         '--trigger-topic=${_TRIGGER_TOPIC}',
         '--update-env-vars=PROJECT_ID=${PROJECT_ID}',
         '--update-env-vars=ENVIRONMENT=${_ENVIRONMENT}',
         '--update-labels=user=trellis',
         '--update-labels=task=delete-blob',
  ]
